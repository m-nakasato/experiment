class e{#e;#t;constructor(e,t){this.#e=e,this.#t=t}static get notes(){return"C,C#,D,D#,E,F,F#,G,G#,A,A#,B".split(",")}static freq(t){let s=t.slice(0,-1);return 27.5*2**Number(t.slice(-1))*(2**(1/12))**(e.notes.indexOf(s)-9)}getSrc(t){return new OscillatorNode(this.#e,{type:this.#t,frequency:e.freq(t)})}}class t{#e;#s=[];constructor(e,t=[]){this.#e=e,this.#i(t)}static dft(e,t){let s=new Float32Array(t),i=new Float32Array(t);for(let l=1;l<=t;l++)for(let n=0;n<t;n++){let a=Math.floor(n/t*e.length),r=2*Math.PI*l*n/t;s[l]+=e[a]*Math.cos(r),i[l]+=e[a]*Math.sin(r)}return{real:s,imag:i}}#i(e){e.forEach(((e,s)=>{let i=[];for(let t=0;t<e.length;t++)i[t]=parseInt(e.charAt(t),16);this.#s[s]=new PeriodicWave(this.#e,t.dft(i,512))}))}getSrc(t,s){return new OscillatorNode(this.#e,{periodicWave:this.#s[s],frequency:e.freq(t)})}}class s{#e;#l;#s=[];constructor(e,{functions:t=[Math.random],pitches:s=[...Array(8)].map(((e,t)=>2**t))}={}){this.#e=e,this.#l=s,this.#i(t)}get notes(){return this.#l}#i(e){let t=this.#e.sampleRate;e.forEach(((e,s)=>{this.#s[s]=[],this.#l.forEach(((i,l)=>{this.#s[s][l]=this.#e.createBuffer(1,t,t);let n,a=this.#s[s][l].getChannelData(0);for(let s=0;s<t;s++)s%i==0&&(n=2*e(s)-1),a[s]=n}))}))}getSrc(e,t){return new AudioBufferSourceNode(this.#e,{buffer:this.#s[t][e],loop:!0})}}class i{#e;#n;#a;#r={};constructor(e,t,s){this.#e=e,this.#n=t,this.#a=s}#o(e,t,s=5,i="sine"){let l=new OscillatorNode(this.#e,{type:i,frequency:s});l.start();let n=new GainNode(this.#e,{gain:t});l.connect(n).connect(e)}#c(e,t,s,i,l){let[n,a,r,o]=l;e.setValueAtTime(0,t),e.linearRampToValueAtTime(i,t+n),e.linearRampToValueAtTime(i*r,t+n+a),e.setValueAtTime(i*r,s-o),e.linearRampToValueAtTime(0,s)}get now(){return this.#e.currentTime}get notes(){return this.#n instanceof s?this.#n.notes:e.notes}play(e,{tone:i=0,sTime:l=this.now,dur:n=.03,vol:a=1,det:r=0,swp:o=0,swg:c=0,env:u=[.01,.01,.5,.01],vib:h=[],trem:p=[]}={}){let _=l+n;c&&(l+=n/3);let f=this.#n.getSrc(e,i),d=f.frequency?f.frequency.value:this.#e.sampleRate/this.#n.notes[e];null==h[0]?(f.detune.value=r,f.detune.linearRampToValueAtTime(r+o,_)):this.#o(f.frequency,...h),this.#n instanceof t||(a/=4);let v=new GainNode(this.#e);this.#c(v.gain,l,_,a,u),null!=p[0]&&this.#o(v.gain,...p),this.#a&&v.connect(this.#a),f.connect(v).connect(this.#e.destination),f.start(l),f.stop(_);let A=crypto.randomUUID();return this.#r[A]=f,f.onended=()=>{f.disconnect(),this.#n instanceof s&&(f.buffer=null),delete this.#r[A]},{eTime:_,freq:d}}discard(){Object.keys(this.#r).forEach((e=>this.#r[e].stop()))}}class l{#e;#u;#h;#p="12px Courier";#_="#022";#f="#999";#d="#0f0";constructor(e){this.#e=e,this.#u=new AnalyserNode(e,{fftSize:1024,smoothingTimeConstant:0}),this.#h=256}get node(){return this.#u}getOscillo(e=0){let t=document.createElement("canvas");t.width=this.#h,t.height=this.#h;let s=new Uint8Array(this.#u.frequencyBinCount),i=new Float32Array(this.#h);this.#u.getByteTimeDomainData(s),this.#u.getFloatTimeDomainData(i);let l=this.#e.sampleRate/e,n=0,a=0,r=0;for(let e=1;e<1.5*l;e++)Math.abs(i[r])>Math.abs(i[e])&&i[e-1]<i[e]&&(r=e);for(let e=0;e<this.#h;e++)i[n]<i[e]?n=e:i[a]>i[e]&&(a=e);let o=t.getContext("2d");o.font=this.#p,o.fillStyle=this.#_,o.fillRect(0,0,this.#h,this.#h),o.fillStyle=this.#f,o.fillRect(0,this.#h/4,this.#h,1),o.fillRect(0,this.#h/2,this.#h,1),o.fillRect(0,this.#h/4*3,this.#h,1),o.strokeStyle=this.#d,o.lineWidth=2,o.lineJoin="round";let c=1/this.#e.sampleRate,u=1/e,h=-1;o.beginPath(),o.moveTo(-r,this.#h-s[0]);for(let e=0;e<s.length;e++){let t=Math.floor(e*c*1e3);h<t&&(o.fillStyle=this.#f,o.fillRect(e,0,1,this.#h),h=t,o.fillStyle=this.#f,o.fillText(t+"ms",e,12)),o.lineTo(e-r,this.#h-s[e])}return o.stroke(),o.fillStyle=this.#d,o.fillText("sampleRate: "+this.#e.sampleRate/1e3+"kHz",10,32),o.fillText("frequency: "+e.toFixed(3)+"Hz",10,48),o.fillText("period: "+(1e3*u).toFixed(3)+"msec ("+Math.round(l)+"bit)",10,64),o.fillText("max:  "+i[n],10,this.#h-48+5),o.fillText("min: "+i[a],10,this.#h-32+5),t}getSpectrum(){let e=document.createElement("canvas");e.width=this.#h,e.height=this.#h;let t=new Uint8Array(this.#h);this.#u.getByteFrequencyData(t);let s=e.getContext("2d");s.font=this.#p,s.fillStyle=this.#_,s.fillRect(0,0,this.#h,this.#h),s.fillStyle=this.#f,s.fillRect(0,this.#h/4,this.#h,1),s.fillRect(0,this.#h/2,this.#h,1),s.fillRect(0,this.#h/4*3,this.#h,1);let i=this.#e.sampleRate/2/this.#u.frequencyBinCount,l=-1;for(let e=0;e<this.#h;e++){let n=Math.floor(e*i/1e3);l<n&&(l=n,s.fillStyle=this.#f,s.fillRect(e,0,1,this.#h),l%2||s.fillText(l+"kHz",e,12)),s.fillStyle=this.#d,s.fillRect(e,this.#h-t[e],1,t[e])}return e}}function n(e=1){let t=1,s=(e,t)=>(e&1<<t)>>t;return function(){let i=s(t,0)^s(t,e);return t>>=1,t|=i<<14,i}}const a=document.querySelector.bind(document),r=document.querySelectorAll.bind(document);let o,c,u,h,p=new XMLHttpRequest;p.responseType="arraybuffer",p.withCredentials=!0,p.onload=()=>{y("response"),o.decodeAudioData(p.response,(e=>h=e));let e=new AudioBufferSourceNode(o,{buffer:h});e.connect(o.destination);let t=o.currentTime;e.start(t),e.stop(t+1),e.onended=()=>{e.disconnect(),e.buffer=null}};let _,f={test:"8BEDA8ADFE410279CEDCCB9757413545",Ah:"DFFD8311259BCCBA8754338CED820025",Ee:"ABCCDEEEFFEDCA874474046225644788",Oo:"CDBA999BDFFEC9753443365354102469",Eh:"FFECA8743019804EF869CB758A88BEFF",Oh:"DFFFDA864322123579CFFEDD82001347",sinesaw:"8ACDEEFFFFEEDCA80123456789ABCDEF",dblsaw:"0123456789ABCDEF02468ACE02468ACE",arrow1:"00FF11EE22DD33CC44BB55AA66997788",arrow2:"0000EEEE2222CCCC4444AAAA66668888",epiano:"756424202202545877BCBFFEEFCDEBAB",guitar:"8FDBABB0047B657650358ACA6A531254",bass:"011234556778899ABCDEFDCA86420677",tom1:"00112469BDEEEFFFFEEEEDB964211100",tom2:"BB9999999999AACC0000000000000000",custom:"FFFFFFFFFFFFFFFF0000000000000000"};class d{#v;#A;#m;#C;#F;constructor(e,t){this.#v=e,this.#A=this.#E(t),this.#C=t}#y(e,t){let s=[];return e.forEach((e=>{if(/^[%\*][24]?$/.test(e)){let t=/[24]/.exec(e);t=null===t?1:t[0]-0;for(let e=0;e<t;e++)s.push(s[s.length-t])}else t?s.push(this.#y(e.split("/"))):s.push(e)})),s}#b(e,t){t.forEach((t=>{let[s,i]=t.split(":");e[1][s]=isNaN(i)?i.split("-").map((e=>isNaN(e)?e:Number(e))):i-0}))}#E(e){let t=[],s=60/e.bpm;return e.notes.forEach(((i,l)=>{let n=this.#y(i.split("|"),1),a=[];e.barSeq.forEach((t=>{n[t].forEach((t=>{let i;t.split(" ").forEach((t=>{if("+"==t)return void a.push(i);let n=t.split(","),r=[n[0],{}],o=/\.$/.test(n[1])?1.5:1;if(/t$/.test(n[1])&&(n[1]=n[1].slice(0,-1),n[1]*=1.5),r[1].dur=4*s/n[1]*o,e.set[l].ini&&this.#b(r,e.set[l].ini.split(",")),n.length>2&&/^set/.test(n[2])){let t=n[2].split(":")[1],s=e.set[l][t].split(",");n.pop(),s.forEach((e=>n.push(e)))}n.length>2&&this.#b(r,n.slice(2)),i=r,a.push(r)}))}))})),t.push(a)})),t}#w(e,t,s){let i=0;return t.forEach((t=>{let l=s;e>0&&(l-=e),this.#A[t].forEach((e=>{l<0||"_"==e[0]?l+=e[1].dur:(e[1].sTime=l,l=this.#v[t].play(...e).eTime)})),i<l&&(i=l)})),{sTime:s,eTime:i}}#g(){let e=this.#C.notes.length;return[...Array(e)].map(((e,t)=>t))}play(e=0,t=this.#g(),s=this.#v[0].now,i=0){let l=this.#C,n=60*l.beat/l.bpm*l.intro,a=0==i?e:n,r=this.#w(a,t,s);y(JSON.stringify(r)+"cnt: "+i),l.loop&&(this.#F=setTimeout((()=>{this.play(e,t,r.eTime,i+1)}),1e3*(r.eTime-r.sTime)))}stop(){clearTimeout(this.#F),this.#v.forEach((e=>e.discard()))}}let v={bpm:100,beat:4,loop:1,intro:1,notes:["_,16/E5,16 + _,16 E5,16/_,16 C5,16 E5,16 _,16/G5,16 _,8./G4,16 _,8.|C5,16 _,8 G4,16/_,8 E4,16 _,16/_,16 A4,16 _,16 B4,16/_,16 A#4,16 A4,16 _,16|G4,8t,set:tri E5,8t,set:tri G5,8t,set:tri/A5,16 _,16 F5,16 G5,16/_,16 E5,16 _,16 C5,16/D5,16 B4,16 _,8|_,8 G5,16 F#5,16/F5,16 D#5,16 _,16 E5,16/_,16 G#4,16 A4,16 C5,16/_,16 A4,16 C5,16 D5,16|_,8 G5,16 F#5,16/F5,16 D#5,16 _,16 E5,16/_,16 C6,16 _,16 C6,16/C6,16 _,8.|_,8 G5,16 F#5,16/F5,16 D#5,16 _,16 E5,16/_,16 G#4,16 A4,16 C5,16/_,16 A4,16 C5,16 D5,16|_,8 D#5,16 _,16/_,16 D5,16 _,8/C5,16 _,8./_,4|C5,16 + _,16 C5,16/_,16 C5,16 D5,16 _,16/E5,16 C5,16 _,16 A4,16/G4,16 _,8.|C5,16 + _,16 C5,16/_,16 C5,16 D5,16 E5,16/_,4/*|E5,16 C5,16 _,16 G4,16/_,8 G#4,16 _,16/A4,16 F5,16 _,16 F5,16/A4,16 _,8.|B4,8t,set:tri A5,8t,set:tri +/A5,8t,set:tri G5,8t,set:tri F5,8t,set:tri/E5,16 C5,16 _,16 A4,16/G4,16 _,8.|B4,16 F5,16 _,16 F5,16/F5,8t,set:tri E5,8t,set:tri D5,8t,set:tri/C5,16 _,8./_,4","_,16/F#4,16 + _,16 F#4,16/_,16 F#4,16 + _,16/B4,16 _,8./_,4|E4,16 _,8 C4,16/_,8 G3,16 _,16/_,16 C4,16 _,16 D4,16/_,16 C#4,16 C4,16 _,16|C4,8t,set:tri G4,8t,set:tri B4,8t,set:tri/C5,16 _,16 A4,16 B4,16/_,16 A4,16 _,16 E4,16/F4,16 D4,16 _,8|_,8 E5,16 D#5,16/D5,16 B4,16 _,16 C5,16/_,16 E4,16 F4,16 G4,16/_,16 C4,16 E4,16 F4,16|_,8 E5,16 D#5,16/D5,16 B4,16 _,16 C5,16/_,16 F5,16 _,16 F5,16/F5,16 _,8.|_,8 E5,16 D#5,16/D5,16 B4,16 _,16 C5,16/_,16 E4,16 F4,16 G4,16/_,16 C4,16 E4,16 F4,16|_,8 G#4,16 _,16/_,16 F4,16 _,8/E4,16 _,8./_,4|G#4,16 + _,16 G#4,16/_,16 G#4,16 A#4,16 _,16/G4,16 E4,16 _,16 E4,16/C4,16 _,8.|G#4,16 + _,16 G#4,16/_,16 G#4,16 A#4,16 G4,16/_,4/*|C5,16 A4,16 _,16 E4,16/_,8 E4,16 _,16/F4,16 C5,16 _,16 C5,16/F4,16 _,8.|G4,8t,set:tri F5,8t,set:tri +/F5,8t,set:tri E5,8t,set:tri D5,8t,set:tri/C5,16 A4,16 _,16 F4,16/E4,16 _,8.|G4,16 D5,16 _,16 D5,16/D5,8t,set:tri C5,8t,set:tri B4,8t,set:tri/G4,16 E4,16 _,16 E4,16/C4,16 _,8.","_,16/D3,16 + _,16 D3,16/_,16 D3,16 + _,16/G4,16 _,8./G3,16 _,8.|G3,16 _,8 E3,16/_,8 C3,16 _,16/_,16 F3,16 _,16 G3,16/_,16 F#3,16 F3,16 _,16|E3,8t C4,8t E4,8t/F4,16 _,16 D4,16 E4,16/_,16 C4,16 _,16 A3,16/B3,16 G3,16 _,8|C3,16 _,8 G3,16/_,8 C4,16 _,16/F3,16 _,8 C4,16/C4,16 + F3,16 _,16|C3,16 _,8 E3,16/_,8 G3,16 C4,16/_,16 G5,16 _,16 G5,16/G5,16 _,16 G3,16 _,16|C3,16 _,8 G3,16/_,8 C4,16 _,16/F3,16 _,8 C4,16/C4,16 + F3,16 _,16|C3,16 _,16 G#3,16 _,16/_,16 A#3,16 _,8/C4,16 _,8 G3,16/G3,16 _,16 C3,16 _,16|G#2,16 _,8 D#3,16/_,8 G#3,16 _,16/G3,16 _,8 C3,16/_,8 G2,16 _,16|%|C3,16 _,8 F#3,16/G3,16 _,16 C4,16 _,16/F3,16 _,16 F3,16 _,16/C4,16 + F3,16 _,16|D3,16 _,8 F3,16/G3,16 _,16 B3,16 _,16/G3,16 _,16 G3,16 _,16/C4,16 + G3,16 _,16|G3,16 _,8 G3,16/G3,8t A3,8t B3,8t/C4,16 _,16 G3,16 _,16/C3,16 _,8.","_,16/1,16 _,16 1,16,set:chh 1,16/_,16 1,16,set:chh 1,16 _,16/1,16 _,8 1,16/_,16 1,16,set:chh + +|19,16,set:bd _,16 1,16,set:chh 1,16,set:chh2/1,16 _,16 1,16,set:chh 1,16,set:chh2/*2|%|%2|%2|1,16 _,8 1,16/_,8 1,16 _,16/1,16 _,8 1,16/_,16 1,16,set:chh + +|%|1,16,set:chh _,8 1,16,set:chh/1,16 _,16 1,16,set:chh _,16/*2|%|%"],barSeq:[0,1,2,1,2,3,4,5,6,3,4,5,6,7,8,7,0,1,2,1,2,9,10,9,11,9,10,9,11,7,8,7,0,9,10,9,11],set:[{ini:"env:.01-.15-.75-.05,vol:.85",tri:"env:.01-.151-.0-.0,vol:.85"},{ini:"env:.01-.15-.75-.05,vol:.85",tri:"env:.01-0-1-.03,vol:.85"},{ini:"env:.01-.15-1-.05"},{ini:"env:0-.15-0-.05,vol:.5",chh:"env:.01-.01-0-0,vol:.5",chh2:"env:.01-.01-0-0,vol:.5,swg:1",bd:"env:0-.2-0-.13,vol:.5"}]};function A(e,t){o.currentTime;let s=setInterval((()=>{a("#analyser").innerHTML="",a("#analyser").append(c.getOscillo(e)),a("#analyser").append(" "),a("#analyser").append(c.getSpectrum())}),1/e*1e3*50);setTimeout((()=>clearTimeout(s)),1e3*t-100)}function m(e){r("#keyboard input").forEach((e=>e.remove()));let t=a("#waveform").value;if("noise"==t){let t=e.notes;for(let e=0;e<t.length;e++){let t=document.createElement("input");t.setAttribute("type","button"),t.setAttribute("value",e),a("#keyboard").append(t)}}else if("fcNoise"==t){let t=e.notes;for(let e=0;e<t.length;e++){let t=document.createElement("input");t.setAttribute("type","button"),t.setAttribute("value",e),a("#keyboard").append(t)}}else for(let t=2;t<8;t++)for(let s=0;s<12&&!(7==t&&s>0);s++){let i=e.notes[s],l=i+t,n=document.createElement("input");n.setAttribute("type","button"),n.setAttribute("value",l),"#"==i.slice(-1)&&n.classList.add("short"),a("#keyboard").prepend(n)}r("#keyboard input").forEach((t=>{t.addEventListener("touchstart",(e=>{e.preventDefault()})),t.addEventListener("pointerdown",(t=>{t.preventDefault();let s=t.target.value,i=""==a("#tone").value?void 0:a("#tone").value,l=isNaN(a("#duration").valueAsNumber)?void 0:a("#duration").valueAsNumber,n=isNaN(a("#volume").valueAsNumber)?void 0:a("#volume").valueAsNumber,r=isNaN(a("#detune").valueAsNumber)?void 0:a("#detune").valueAsNumber,o=isNaN(a("#sweep").valueAsNumber)?void 0:a("#sweep").valueAsNumber,c=a("#envA").valueAsNumber,u=a("#envD").valueAsNumber,h=a("#envS").valueAsNumber,p=a("#envR").valueAsNumber,_=isNaN(c)||isNaN(u)||isNaN(h)||isNaN(p)?void 0:[c,u,h,p],f=isNaN(a("#vDepth").valueAsNumber)?void 0:a("#vDepth").valueAsNumber,d=isNaN(a("#vRate").valueAsNumber)?void 0:a("#vRate").valueAsNumber,v=""==a("#vWave").value?void 0:a("#vWave").value,m=isNaN(a("#tDepth").valueAsNumber)?void 0:a("#tDepth").valueAsNumber,C=isNaN(a("#tRate").valueAsNumber)?void 0:a("#tRate").valueAsNumber,F=""==a("#tWave").value?void 0:a("#tWave").value,E=e.play(s,{tone:i,dur:l,vol:n,det:r,swp:o,env:_,vib:[f,d,v],trem:[m,C,F]});t.target.classList.add("on"),A(E.freq,l)})),t.addEventListener("pointerup",(e=>{e.preventDefault(),e.target.classList.remove("on")}))})),"gbWave"==t?(""==a("#cwt table").innerHTML&&function(){let e=a("#cwt table");e.innerHTML="";for(let t=15;t>=0;t--){let s=document.createElement("tr");for(let e=0;e<32;e++){let i=document.createElement("td"),l=document.createElement("input");l.setAttribute("type","radio"),l.setAttribute("name","cwt"+e),l.setAttribute("value",t.toString(16).toUpperCase()),i.append(l),s.append(i)}e.append(s)}r("#cwt input[type=radio]").forEach((e=>{e.onclick=e=>{let t=e.target.name.replace("cwt",""),s=a("#cwt input[type=text]"),i="";for(let l=0;l<s.value.length;l++)i+=l==t?e.target.value:s.value[l];s.value=i,a("#cwt input[type=text]").dispatchEvent(new Event("change"))}})),a("#cwt input[type=text]").dispatchEvent(new Event("change"))}(),a("#cwt").classList.remove("hide")):a("#cwt").classList.add("hide")}function C(l,r){let c,u;switch(l){case"sine":case"square":case"sawtooth":case"triangle":c=e,u=l;break;case"fcPulse":c=t,u=["F0","F000","F0000000"];break;case"fcTriangle":c=t,u=["0123456789ABCDEFFEDCBA9876543210"];break;case"noise":c=s,u={};break;case"fcNoise":let i=[n(),n(6)],r=[...new Set([4,8,16,32,64,96,128,160,202,254,380,508,762,1016,2034,4068].map((e=>Math.round(o.sampleRate/1789772.5*e))))].filter((e=>0!=e));c=s,u={functions:i,pitches:r};break;case"gbWave":let h=a("#cwt input[type=text]").value;f.custom=h,c=t,u=Object.values(f)}let h=new c(o,u);return new i(o,h,r)}function F(){let e=a("#waveform").value;u=C(e,c.node)}function E(){a("#state").onclick=()=>{y(o.state)},a("#resume").onclick=()=>{o.resume()},a("#memChk").onclick=()=>{y(window.crossOriginIsolated)},a("#keyA2").onclick=()=>{p.open("GET","./Piano.ff.A2.m4a",!0),p.send()},a("#pwr").onclick=()=>{a("#pwr").classList.contains("on")?o.close():(o=new window.AudioContext,c=new l(o),F(),m(u)),a("#pwr").classList.toggle("on")},a("#waveform").onchange=e=>{a("#tone").innerHTML="";let t=[];0==e.target.value.indexOf("fcPulse")?t=["1:1","1:3","1:7"]:"gbWave"==e.target.value?t=Object.keys(f):"fcNoise"==e.target.value&&(t=["long","short"]),t.forEach(((e,t)=>{let s=document.createElement("option");s.innerText=e,s.value=t,a("#tone").append(s)})),F(),m(u)},a("#cwt input[type=text]").onchange=e=>{F(),m(u)},a("#coin").onclick=()=>{let e=""==a("#tone").value?void 0:a("#tone").value,t=u.play("B5",{tone:e,dur:.1});A(u.play("E6",{tone:e,sTime:t.eTime,dur:1,env:[0,0,1,1]}).freq,1.1)},a("#gameover").onclick=()=>{let e=C("fcPulse"),t=C("fcTriangle"),s=.4,i=[["A#4","A#4","A#4","A#4","C#5","C5","C#5","C5","A#4","A#4","A#4","A#4"],["F4","F#4","F4","F#4","F4","F#4","F4","F#4"],["A#3","C#4","A#3","C#4","A#3","C#4","A#3","C#4"]],l=[[s,s/3*2,s/3,s,s/3*2,s/3,.04,s/3*2-.04,s/3,s/3*2,s/3,.8],[s,s,s,s,s,s,s,s],[s,s,s,s,s,s,s,s]],n=[];n[0]=t.play(i[0][0],{dur:l[0][0],vol:1}),n[1]=e.play(i[1][0],{dur:l[1][0],vol:.75}),n[2]=e.play(i[2][0],{dur:l[2][0],vol:.75});for(let e=1;e<i[0].length;e++)n[0]=t.play(i[0][e],{sTime:n[0].eTime,dur:l[0][e],vol:1});for(let t=1;t<i[1].length;t++)n[1]=e.play(i[1][t],{sTime:n[1].eTime,dur:l[1][t],vol:.75}),n[2]=e.play(i[2][t],{sTime:n[2].eTime,dur:l[2][t],vol:.75})},a("#seqPlay").onclick=()=>{!function(){let e=[];r("#ch select").forEach((t=>e.push(C(t.value))));let t=a("#bpm").valueAsNumber;v.bpm=t,_=new d(e,v);let s=a("#skip").value,i=[];r("#ch li input").forEach(((e,t)=>{e.checked&&i.push(t)})),_.play(2.4*s,i)}()},a("#seqStop").onclick=()=>_.stop(),a("#cwt input[type=text]").onchange=e=>{let t=e.target;""==t.value&&(t.value="FFFFFFFFFFFFFFFF0000000000000000");for(let e=0;e<t.value.length;e++)r("input[name=cwt"+e+"]").forEach((s=>{s.checked=t.value[e]==s.value}));F()},a("#cwt input[type=button]").onclick=e=>{let t=a("#tone").value;if("custom"==t)return;let s=f[t];a("#cwt input[type=text]").value=s,a("#cwt input[type=text]").dispatchEvent(new Event("change"))},function(){let e=a("#ch"),t=["fcPulse","fcPulse","fcTriangle","fcNoise"];for(let s=0;s<4;s++){let i=document.createElement("li"),l=document.createElement("input");l.setAttribute("type","checkbox"),l.setAttribute("checked","checked"),i.append(l);let n=a("#waveform").cloneNode(!0);n.removeAttribute("id"),n.value=t[s],i.append(n),e.append(i)}for(let e=0;e<v.barSeq.length;e++){let t=document.createElement("option");t.innerText=e,a("#skip").append(t)}}()}function y(e){a("#debug").innerHTML=a("#debug").innerHTML+"<br/>"+e}window.onload=function(){E()};
